/* src/styles/globals.css - Tailwind v4 Centralized Design System */

@import "tailwindcss";

@theme {
  --font-sans: 'Inter', system-ui, -apple-system, sans-serif;
  --color-surface-0: #393e50;
  --color-surface-1: #444a5e;
  --color-surface-2: #4f5569;
  --color-border: #52586e;
  --color-border-muted: #444a5e;
  --color-text: #ffffff;
  --color-text-muted: #c5c9d6;
  --color-text-inverted: #393e50;
  --color-accent: #ff9da0;
  --color-accent-hover: #fff4cc;
  --color-accent-muted: rgba(255, 157, 160, 0.15);
  --color-info: #ccd1ff;
  --color-success: #ccffda;
  --color-warning: #fff4cc;
  --color-error: #ff9da0;
  --text-h1: 1.8rem;
  --text-h2: 1.6rem;
  --text-h3: 1.4rem;
  --text-h4: 1.2rem;
  --text-small: 0.875rem;
  --radius: 0.5rem;
  --radius-lg: 0.75rem;
  --shadow: 0 8px 24px -4px rgba(0, 0, 0, 0.25);
  --header-height: 4rem;
  --sidebar-width: 18rem;
  --infobox-width: 280px;
}

@keyframes fade-in { from { opacity: 0; } to { opacity: 1; } }
@keyframes slide-up { from { opacity: 0; transform: translateY(8px); } to { opacity: 1; transform: translateY(0); } }
@keyframes spin { to { transform: rotate(360deg); } }

@layer base {
  html { font-size: 16px; line-height: 1.5; -webkit-font-smoothing: antialiased; scroll-behavior: smooth; }
  body { @apply bg-surface-0 text-text text-base min-h-screen; }

  h1, h2, h3, h4 { &:first-child { @apply mt-0; } }
  h1 { @apply text-h1 font-bold mt-8 mb-4; }
  h2 { @apply text-h2 font-semibold mt-8 mb-4 border-b-2 border-border scroll-mt-[calc(var(--header-height)+1rem)]; }
  h3 { @apply text-h3 font-normal mt-6 mb-4 scroll-mt-[calc(var(--header-height)+1rem)]; }
  h4 { @apply text-h4 font-light mt-4 mb-4 scroll-mt-[calc(var(--header-height)+1rem)]; }

  p { @apply mb-4 last:mb-0; }
  ul, ol { @apply mb-4 pl-8; :is(ul, ol) { @apply mt-1 mb-0; } }
  ul { list-style-type: disc; }
  ol { list-style-type: decimal; }
  li { @apply mb-1 last:mb-0; }

  a { @apply text-accent no-underline hover:text-accent-hover; }
  code { @apply text-[0.9em] px-1.5 py-0.5 bg-surface-2 rounded; }
  pre { @apply text-base border border-border-muted rounded-lg p-4 overflow-x-auto; background-color: #24292e; code { @apply p-0 bg-transparent; } }
  blockquote { @apply border-l-4 border-accent pl-4 py-1 italic text-text-muted; }

  table { @apply w-full border-collapse rounded-lg overflow-hidden; }
  th, td { @apply border border-border-muted py-2 px-3 text-left align-top; }
  th { @apply bg-surface-1 font-semibold; }
  td { @apply bg-surface-2; }
  tr:first-child :is(th, td):first-child { border-top-left-radius: var(--radius); }
  tr:first-child :is(th, td):last-child { border-top-right-radius: var(--radius); }
  tr:last-child td:first-child { border-bottom-left-radius: var(--radius); }
  tr:last-child td:last-child { border-bottom-right-radius: var(--radius); }
  tr:hover td { @apply bg-white/5; }

  ::selection { @apply bg-accent-muted text-text; }
  :focus-visible { @apply outline-2 outline-accent outline-offset-2; }
  
  ::-webkit-scrollbar { @apply w-2 h-2; }
  ::-webkit-scrollbar-track { @apply bg-surface-1; }
  ::-webkit-scrollbar-thumb { @apply bg-border rounded; &:hover { @apply bg-text-muted; } }

  input, textarea, select { font: inherit; color: inherit; }
  hr { @apply border-0 border-t border-border-muted; }

  /* Tiptap editor */
  .tiptap-editor .tiptap {
    @apply outline-none;
    p { @apply mb-3; }
    h2, h3 { @apply font-semibold border-b-0; }
    h2 { @apply mt-6 mb-3; }
    h3 { @apply mt-4 mb-2; }
    ul, ol { @apply pl-6 mb-3; }
    blockquote { @apply my-3 py-0; }
    a { @apply underline underline-offset-2; }
    pre { background-color: #24292e; }
    p.is-editor-empty:first-child::before { content: attr(data-placeholder); @apply float-left text-text-muted opacity-60 pointer-events-none h-0; }
    .selectedCell { @apply bg-accent-muted; }
    &.ProseMirror-selectednode .iframe-embed { @apply outline-2 outline-accent outline-offset-2 rounded-lg; }
  }

  :is(.tiptap-editor .tiptap, .prose-content) {
    img { @apply max-w-full h-auto rounded-lg my-4; &.ProseMirror-selectednode { @apply outline-2 outline-accent outline-offset-2; } }
    div[data-youtube-video] { @apply relative w-full my-4; &::before { content: ''; @apply block pt-[56.25%]; } iframe { @apply absolute inset-0 w-full! h-full! rounded-lg; } &.ProseMirror-selectednode iframe { @apply outline-2 outline-accent outline-offset-2; } }
    .iframe-embed { @apply relative w-full min-h-[400px]; iframe { @apply w-full h-[400px] border border-border-muted rounded-lg bg-surface-1; } }
    .twitter-embed { @apply my-4 max-w-[550px]; iframe { @apply w-full border-0 rounded-lg min-h-[200px]; } }
  }

  /* Code block with language selector */
  .code-block-wrapper { @apply relative my-4; pre { @apply m-0 border border-border-muted rounded-lg p-4 pr-24 overflow-x-auto; background-color: #24292e; } code { @apply bg-transparent p-0; } }

  /* Tabs - consolidated */
  [data-tabs] {
    .tabs-list { @apply flex gap-1 border-b border-border-muted mb-4; }
    .tab-button { @apply py-2 px-4 bg-transparent border-b-2 border-transparent text-text-muted cursor-pointer transition-all hover:text-text; &.active { @apply text-accent border-accent; } }
    .tab-panel, [data-tab-item] { @apply hidden; &.active { @apply block; } }
  }
  .tabs-editor {
    @apply border border-border-muted rounded-lg overflow-hidden;
    .tabs-list { @apply flex items-center gap-1 p-2 bg-surface-1 border-b border-border-muted mb-0; }
    .tab-button-edit { @apply flex items-center gap-1 py-1 px-2 bg-surface-2 rounded border border-transparent; &.active { @apply bg-accent-muted border-accent; } }
    .tab-title-input { @apply bg-transparent border-0 outline-none w-24 text-small text-text placeholder:text-text-muted; }
    .tab-remove { @apply p-0.5 rounded-sm text-text-muted cursor-pointer hover:text-error hover:bg-surface-2; }
    .tab-add { @apply py-1 px-2 text-text-muted cursor-pointer rounded hover:text-accent hover:bg-surface-2; }
    .tabs-content { @apply p-4; }
  }
  [data-tabs][data-active-tab="0"] [data-tab-item]:nth-of-type(1),
  [data-tabs][data-active-tab="1"] [data-tab-item]:nth-of-type(2),
  [data-tabs][data-active-tab="2"] [data-tab-item]:nth-of-type(3),
  [data-tabs][data-active-tab="3"] [data-tab-item]:nth-of-type(4),
  [data-tabs][data-active-tab="4"] [data-tab-item]:nth-of-type(5),
  [data-tabs][data-active-tab="5"] [data-tab-item]:nth-of-type(6) { @apply block; }

  /* Shiki code blocks */
  .shiki { @apply border border-border-muted rounded-lg p-4 overflow-x-auto; code { @apply p-0 bg-transparent; } }
}

@layer components {
  .stack { @apply flex flex-col gap-4; }
  .stack-xs { @apply flex flex-col gap-1; }
  .stack-sm { @apply flex flex-col gap-2; }
  .stack-lg { @apply flex flex-col; }
  .row { @apply flex items-center gap-2; }
  .row-md { @apply flex items-center gap-4; }
  .spread { @apply flex items-center justify-between gap-4 flex-wrap; }
  .center { @apply flex items-center justify-center; }

  .surface { @apply bg-surface-1 border border-border-muted rounded-lg; }
  .surface-interactive { @apply bg-surface-1 border border-border-muted rounded-lg transition-all hover:border-accent hover:-translate-y-0.5 hover:shadow; }
  .panel { @apply bg-surface-0 border border-border-muted rounded-lg p-6; }

  .icon-btn { @apply p-2 rounded transition-colors cursor-pointer inline-flex items-center justify-center hover:bg-surface-2; }
  .input { @apply w-full py-2 px-4 bg-surface-0 border border-border rounded transition-all focus:outline-none focus:border-accent focus:ring-2 focus:ring-accent-muted placeholder:text-text-muted placeholder:opacity-60; }
  .input-ghost { @apply w-full bg-transparent border-0 outline-none placeholder:text-text-muted placeholder:opacity-60; }
  .callout { @apply flex gap-4 p-4 rounded-lg border border-info/30 bg-info/10; }

  .dropdown { @apply absolute right-0 top-full mt-2 min-w-48 bg-surface-1 border border-border rounded shadow py-1 z-50; }
  .dropdown-item { @apply w-full flex items-center gap-2 py-2 px-4 text-left transition-colors hover:bg-surface-2; }

  .badge { @apply inline-flex items-center py-0.5 px-2 text-small font-medium rounded-full bg-surface-2 text-text-muted; }
  .badge-accent { @apply bg-accent-muted text-accent; }

  .skeleton { @apply bg-surface-1 rounded-lg animate-pulse; }
  .link-muted { @apply text-text-muted hover:text-text; }

  .banner-container { @apply relative w-full aspect-[4/1] max-h-48 overflow-hidden bg-surface-1 rounded-lg; }
  .banner-image { @apply w-full h-full object-cover object-center; }
  .banner-placeholder { @apply w-full h-full bg-linear-to-br from-surface-1 to-surface-2; }
  .banner-overlay { @apply absolute inset-0 flex flex-col justify-end p-3 sm:p-4 lg:p-6 bg-linear-to-t from-black/80 via-black/40 to-transparent text-text gap-1 sm:gap-2; h1 { @apply text-base sm:text-h3 lg:text-h1 leading-tight; text-shadow: 0 2px 8px rgba(0,0,0,0.5); } nav { @apply text-xs sm:text-small font-medium; text-shadow: 0 1px 4px rgba(0,0,0,0.6); a, span { @apply text-white/90 hover:text-white; } } }

  .spinner { @apply inline-block rounded-full border-2 border-current border-t-transparent animate-[spin_0.6s_linear_infinite]; }

  /* Page with infobox layout */
  .page-with-infobox {
    @apply grid gap-6;
    grid-template-columns: 1fr;
    grid-template-areas: "infobox" "content";

    @media (min-width: 768px) {
      grid-template-columns: 2fr 1fr;
      grid-template-areas: "content infobox";
    }

    > .infobox { grid-area: infobox; }
    > .page-main-content { grid-area: content; }
  }

  /* Infobox sidebar */
  .infobox {
    @apply bg-surface-1 border border-border-muted rounded-lg overflow-hidden p-4;
    width: 100%;

    @media (min-width: 768px) {
      position: sticky;
      top: calc(var(--header-height) + 1.5rem);
      align-self: start;
      max-height: calc(100dvh - var(--header-height) - 3rem);
      overflow-y: auto;
    }
  }

  /* Infobox editor sidebar */
  .infobox-editor {
    grid-area: infobox;
    width: 100%;

    @media (min-width: 768px) {
      position: sticky;
      top: calc(var(--header-height) + 1.5rem);
      align-self: start;
      max-height: calc(100dvh - var(--header-height) - 3rem);
      overflow-y: auto;
    }
  }
}

radix-connect-button {
  --radix-connect-button-background: var(--color-accent);
  --radix-connect-button-background-hover: var(--color-accent-hover);
  --radix-connect-button-text: var(--color-text-inverted);
  --radix-connect-button-border-radius: var(--radius);
}